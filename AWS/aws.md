# AWSについてまとめます　

## VPC
VPCとはAWS内部のネットワーク環境であり、セキュリティ面の設定も含まれる。AWSアカウントを作成した時にデフォルトでデフォルトVPCが作成されるが、通常は使わず、個別で作成する。

- マルチVPC…１つのアカウントで複数のVPCを持つこと（中規模向け）
- マルチアカウント…複数の子アカウントを持つこと（大規模むけ）
- AZ…アベイラビリティーゾーン（データセンターのこと）
- リージョン
  - AZを束ねた地域のこと（国のこと）
  - 東京リージョンはAZを３つ持っている
- エッジロケーション…情報をキャッシュする拠点（クラウドフロントで使用）
- ルートテーブル
  - サブネットに関連ずけて使用。
  - サブネットからどこに向けて発信するか決めるルール
  - 最も明確なルールが優先されて適用される
- インターネットゲートウェイ
  - VPC内のAWSリソースとインターネットを繋げる
  - 自動でスケールし、可用性が高い
- ルートテーブルにインターネットゲーウェイに向けた設定をして使用する
- NATゲートウェイ
  - プライベートサブネットからのインターネット接続を可能とする
  - アウトバウンド（発信）はできるが、インバウンド（受信）はできない
- ENI
  - Pアドレスを割り当てて、インスタンスにアタッチ/デタッチする
  - インターネットゲーウェイト接続している
  - ネットワークのセグメントを分ける場合に使う
- PubicIPアドレス
  - AWSのIPアドレスプールより割り当てられる
- ElasticIPアドレス
  - インスタンスにアタッチ/デタッチ可能で静的なIPアドレス
  - インスタンスが停止しても同一アドレス
  - インスタンスにアタッチしていない場合料金が発生する
- サブネットはAZを跨って作成することはできない
- VPCのアドレスレンジ帯は/16〜/28の範囲内で作る
- パブリックサブネット
  - インターネット接続化
  - インターネットゲートウェイへのルーティング有
- プライベートサブネット
  - ルートテーブルにルーティング無し
 <br>

### IPアドレス(サブネット)の基礎(CIDER表記)
```
10/21/**/***/24の場合(*は任意の数字)
サブネットが/24で割り振れるIPの数は256個
1減る毎に割り振れるIPは倍になっていく
23だとIPが512個 、22だとIPが1024個 21だとIPが2048個
つまり
21（2048）の中に /24（256）が8個作れる事になる
（2048を256で割ると8） 10.0.（0）.0/24＝256
```

## EC2
- EC2
  - Elastic Compute Cloud
  - AWSの仮想サーバサービス（インスタンスとも言う）
- AMI
  - Amazon Machine Image（OSのこと）
  - インスタンス作成時に必要な情報
  - Marketplace…ライセンス込みのAMI
  - コミュニティAMI…有志の人たちが無料で提供しているAMI
  - ソフトウェアが搭載されているAMIもある
- インスタンスタイプ（CPUスペックのこと）
  - t3.micro
  - microはインスタンスサイズ（スペックのこと）
  - tはファミリー名
    - 数字は世代番号
    - t3系の特徴として、CPUバーストが特徴
    - t3aのCPUはAMD
    - m系は汎用タイプ
    - c系はコンピューティングに最適化(スペックが高い)
    - r系はメモリが最適化されている
    - p系はGPUが付いている（描写処理、機械学習）
    - h系はストレージが最適化されている（分散ファイルシステム）
- EBS（外付けのディスク）
  - EC2にアタッチして使用する
  - 種類に応じて性能が異なる
  - スナップショット（バックアップ）取れる
  - 同じAZにいなければアタッチすることはできな
  - 複数のEC2からはアタッチすることはできない
  - スナップショットは差分のバックアップのようなもの
- ユーザデータ
  - EC2が初回起動する際に実行するスクリプト
  - 実行権限はroot権限
- インスタンスメタデータ
  - インスタンスが持っている様々なデータ
  - ec2-metadataコマンドで取得する
- キーペア
  - EC2にログインするために使用する公開鍵と秘密鍵にペア
    - 暗号化された公開鍵は秘密鍵でしか解除できない
    - 公開鍵はAWSが保管している
    - 再発行は可能

## IAM
- メールアドレスとパスワードでログインできるユーザーをルートユーザーという
### 認情情報
- アクセスキーID
- シークレットアクセスキー
### IAMグループ
- 複数のIAMユーザーのまとまりである
- ユーザーは個人だけでなく、プログラムが利用する場合もある
- IAMユーザーはそれぞれに認情情報を持っている
### IAMポリシー
- AWSで操作できる権限を表したものでJSON形式で記述された設定ファイル
- 認証主体（プリンシパル）にアタッチして使用
- ユーザーが任意に定義するポリシーをカスタムポリシーという
### IAMロール
- 信頼関係と権限の設定ができる
- ポリシーをアタッチして使用
